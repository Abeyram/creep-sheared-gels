#Leave this at 1 since beta epsilon is then the morse well depth
variable run_temp equal 1
variable run_steps equal 1000000
variable dump_frames equal 100

variable dump_frequency equal ${run_steps}/${dump_frames}
variable thermo_frequency equal ${run_steps}/1000

units		lj 
atom_style	atomic 
atom_modify	map array 

# read interactions
pair_style	hybrid/overlay morse 1.4 dpd/tstat 1.0 1.0 2.5 34387
read_data ${file_name}	
pair_coeff * * dpd/tstat 100 1
pair_modify	shift yes
comm_modify vel yes

minimize 	1e-10 1e-10 3000 3000

change_box all triclinic
velocity all create 1 1234

variable L equal xhi-xlo
print "Box size $L"

timestep 0.001

dump 		dumpatom  all atom ${dump_frequency} gel_equil.atom.gz
dump_modify	dumpatom sort id first yes

variable varstep equal step
variable vartemp equal temp
variable varpress equal press
variable varetotal equal etotal
compute  msd all msd

fix		msd all ave/time 1 1 ${thermo_frequency} c_msd[4] file msd.txt

fix thermo_print 	all print ${thermo_frequency} "${varstep} ${vartemp} ${varpress} ${varetotal}" file gel_equil_${run_steps}.thermo screen no

thermo ${thermo_frequency}
thermo_style custom step temp press pe

## Do Equilibration

fix equilibrate all nvt temp ${run_temp} ${run_temp} 1
run ${run_steps}
unfix equilibrate

write_restart equil_${run_steps}.restart
